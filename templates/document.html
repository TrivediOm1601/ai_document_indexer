{% extends "base.html" %}
{% block title %}Document Details - {{ document['title'] or document['filename'] }}{% endblock %}

{% block content %}
<h3>{{ document['title'] or document['filename'] }}</h3>
<ul class="list-group mb-3">
    <li class="list-group-item"><strong>Author:</strong> {{ document['author'] or '-' }}</li>
    <li class="list-group-item"><strong>Date Created:</strong> {{ document['date_created'] or '-' }}</li>
    <li class="list-group-item">
        <strong>Category:</strong>
        <form method="POST" action="{{ url_for('update_category', document_id=document['id']) }}" class="d-inline-block ms-2">
            <select name="category" class="form-select d-inline-block w-auto" onchange="this.form.submit()">
                {% if role == 'admin' %}
                    <option value="Invoice" {% if document['category'] == 'Invoice' %}selected{% endif %}>Invoice</option>
                    <option value="Financial_Report" {% if document['category'] == 'Financial_Report' %}selected{% endif %}>Financial Report</option>
                    <option value="Contract" {% if document['category'] == 'Contract' %}selected{% endif %}>Contract</option>
                    <option value="Expense_Report" {% if document['category'] == 'Expense_Report' %}selected{% endif %}>Expense Report</option>
                    <option value="Resume" {% if document['category'] == 'Resume' %}selected{% endif %}>Resume</option>
                    <option value="Job_Description" {% if document['category'] == 'Job_Description' %}selected{% endif %}>Job Description</option>
                    <option value="Technical_Manual" {% if document['category'] == 'Technical_Manual' %}selected{% endif %}>Technical Manual</option>
                    <option value="Research_Paper" {% if document['category'] == 'Research_Paper' %}selected{% endif %}>Research Paper</option>
                    <option value="Non_Relevant" {% if document['category'] == 'Non_Relevant' %}selected{% endif %}>Non Relevant</option>
                {% elif role == 'hr' %}
                    <option value="Resume" {% if document['category'] == 'Resume' %}selected{% endif %}>Resume</option>
                    <option value="Job_Description" {% if document['category'] == 'Job_Description' %}selected{% endif %}>Job Description</option>
                {% elif role == 'finance' %}
                    <option value="Invoice" {% if document['category'] == 'Invoice' %}selected{% endif %}>Invoice</option>
                    <option value="Contract" {% if document['category'] == 'Contract' %}selected{% endif %}>Contract</option>
                    <option value="Financial_Report" {% if document['category'] == 'Financial_Report' %}selected{% endif %}>Financial Report</option>
                    <option value="Expense_Report" {% if document['category'] == 'Expense_Report' %}selected{% endif %}>Expense Report</option>
                {% else %}
                    <option value="{{ document['category'] }}" selected>{{ document['category'] }}</option>
                {% endif %}
            </select>
            <noscript><button type="submit" class="btn btn-primary btn-sm mt-1">Update</button></noscript>
        </form>
    </li>
    <li class="list-group-item"><strong>Summary:</strong> <p>{{ document['summary'] or '-' }}</p></li>
</ul>
<a href="{{ url_for('static', filename='../' + document['file_path'].replace('\\', '/')) }}" download class="btn btn-outline-primary">Download</a>
<a href="{{ url_for('dashboard') }}" class="btn btn-secondary ms-2">Back to Dashboard</a>
{% endblock %}
